<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç»„ä»¶æ¼”ç¤º - GoldPulse</title>
    <link rel="stylesheet" href="../css/common.css">
    <link rel="stylesheet" href="../css/components.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', sans-serif;
            background: #0a0a0a;
            color: #fff;
            margin: 0;
            padding: 20px;
        }
        
        .demo-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .demo-section {
            margin-bottom: 40px;
            padding: 30px;
            background: #1a1a1a;
            border-radius: 12px;
            border: 1px solid #333;
        }
        
        .demo-section h2 {
            margin-top: 0;
            color: #ffd700;
            font-size: 1.5rem;
        }
        
        .demo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .demo-controls {
            display: flex;
            gap: 12px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .demo-controls button {
            padding: 10px 20px;
            background: #2a2a2a;
            border: 1px solid #444;
            color: #fff;
            border-radius: 6px;
            cursor: pointer;
        }
        
        .demo-controls button:hover {
            background: #333;
        }
        
        .code-block {
            background: #0a0a0a;
            padding: 16px;
            border-radius: 8px;
            margin-top: 16px;
            overflow-x: auto;
        }
        
        .code-block code {
            color: #00ff64;
            font-family: 'SF Mono', monospace;
            font-size: 0.875rem;
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <h1 style="text-align: center; color: #ffd700; margin-bottom: 40px;">ğŸ§© GoldPulse ç»„ä»¶æ¼”ç¤º</h1>
        
        <!-- å¯¼èˆªæ æ¼”ç¤º -->
        <div class="demo-section">
            <h2>ğŸ“ å¯¼èˆªæ ç»„ä»¶ (gp-navbar)</h2>
            <gp-navbar current-page="markets"></gp-navbar>
            <div class="code-block">
                <code>&lt;gp-navbar current-page="markets"&gt;&lt;/gp-navbar&gt;</code>
            </div>
        </div>
        
        <!-- ä»·æ ¼å¡ç‰‡æ¼”ç¤º -->
        <div class="demo-section">
            <h2>ğŸ’³ ä»·æ ¼å¡ç‰‡ç»„ä»¶ (gp-price-card)</h2>
            <div class="demo-grid">
                <gp-price-card 
                    symbol="XAU" 
                    name="é»„é‡‘" 
                    currency="USD" 
                    price="2650.50" 
                    change="12.30" 
                    change-percent="0.47" 
                    icon="ğŸ¥‡">
                </gp-price-card>
                
                <gp-price-card 
                    symbol="HSI" 
                    name="æ’ç”ŸæŒ‡æ•°" 
                    currency="HKD" 
                    price="19850.25" 
                    change="-125.50" 
                    change-percent="-0.63" 
                    icon="ğŸ‡­ğŸ‡°">
                </gp-price-card>
            </div>
            <div class="demo-controls">
                <button onclick="updateCard1()">æ›´æ–°é»„é‡‘æ•°æ®</button>
                <button onclick="updateCard2()">æ›´æ–°æ’æŒ‡æ•°æ®</button>
            </div>
            <div class="code-block">
                <code>
&lt;gp-price-card 
    symbol="XAU" 
    name="é»„é‡‘" 
    currency="USD" 
    price="2650.50" 
    change="12.30" 
    change-percent="0.47" 
    icon="ğŸ¥‡"&gt;
&lt;/gp-price-card&gt;
                </code>
            </div>
        </div>
        
        <!-- åŠ è½½çŠ¶æ€æ¼”ç¤º -->
        <div class="demo-section">
            <h2>â³ åŠ è½½çŠ¶æ€ç»„ä»¶ (gp-loading)</h2>
            <div class="demo-controls">
                <button onclick="showLoading()">æ˜¾ç¤ºåŠ è½½</button>
                <button onclick="hideLoading()">éšè—åŠ è½½</button>
            </div>
            <gp-loading id="demoLoading" text="æ­£åœ¨è·å–æ•°æ®..."></gp-loading>
            <div class="code-block">
                <code>
// HTML
&lt;gp-loading id="loading" text="æ­£åœ¨è·å–æ•°æ®..."&gt;&lt;/gp-loading&gt;

// JavaScript
document.getElementById('loading').show();
document.getElementById('loading').hide();
                </code>
            </div>
        </div>
        
        <!-- é”™è¯¯æç¤ºæ¼”ç¤º -->
        <div class="demo-section">
            <h2>âš ï¸ é”™è¯¯æç¤ºç»„ä»¶ (gp-error)</h2>
            <div class="demo-controls">
                <button onclick="showError()">æ˜¾ç¤ºé”™è¯¯</button>
                <button onclick="hideError()">éšè—é”™è¯¯</button>
            </div>
            <gp-error id="demoError"></gp-error>
            <div class="code-block">
                <code>
// HTML
&lt;gp-error id="error"&gt;&lt;/gp-error&gt;

// JavaScript
document.getElementById('error').show('ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·é‡è¯•');
document.getElementById('error').hide();

// ç›‘å¬é‡è¯•äº‹ä»¶
document.getElementById('error').addEventListener('retry', () => {
    // é‡æ–°åŠ è½½æ•°æ®
});
                </code>
            </div>
        </div>
        
        <!-- å€’è®¡æ—¶æ¼”ç¤º -->
        <div class="demo-section">
            <h2>â±ï¸ å€’è®¡æ—¶ç»„ä»¶ (gp-countdown)</h2>
            <p style="color: #888;">ä¸‹æ¬¡åˆ·æ–°ï¼š<gp-countdown id="demoCountdown" seconds="300" running></gp-countdown></p>
            <div class="demo-controls">
                <button onclick="startCountdown()">å¼€å§‹</button>
                <button onclick="stopCountdown()">æš‚åœ</button>
                <button onclick="resetCountdown()">é‡ç½®</button>
            </div>
            <div class="code-block">
                <code>
// HTML
&lt;gp-countdown seconds="300" running&gt;&lt;/gp-countdown&gt;

// JavaScript
const countdown = document.getElementById('countdown');
countdown.start();
countdown.stop();
countdown.reset(300);

// ç›‘å¬å€’è®¡æ—¶ç»“æŸ
countdown.addEventListener('countdownEnd', () => {
    // åˆ·æ–°æ•°æ®
});
                </code>
            </div>
        </div>
        
        <!-- è¿·ä½ å›¾è¡¨æ¼”ç¤º -->
        <div class="demo-section">
            <h2>ğŸ“ˆ è¿·ä½ å›¾è¡¨ç»„ä»¶ (gp-sparkline)</h2>
            <div style="width: 300px; background: #1e1e1e; padding: 20px; border-radius: 12px;">
                <gp-sparkline id="demoSparkline" height="80" color="#ffd700"></gp-sparkline>
            </div>
            <div class="demo-controls">
                <button onclick="updateSparkline()">æ›´æ–°æ•°æ®</button>
            </div>
            <div class="code-block">
                <code>
// HTML
&lt;gp-sparkline id="sparkline" height="60" color="#ffd700"&gt;&lt;/gp-sparkline&gt;

// JavaScript
const sparkline = document.getElementById('sparkline');
sparkline.setData([2600, 2620, 2610, 2640, 2630, 2650, 2645, 2652]);
                </code>
            </div>
        </div>
        
        <!-- Store æ¼”ç¤º -->
        <div class="demo-section">
            <h2>ğŸ—„ï¸ çŠ¶æ€ç®¡ç† (Store)</h2>
            <div class="demo-controls">
                <button onclick="addFavorite()">æ·»åŠ æ”¶è—</button>
                <button onclick="removeFavorite()">ç§»é™¤æ”¶è—</button>
                <button onclick="toggleAutoRefresh()">åˆ‡æ¢è‡ªåŠ¨åˆ·æ–°</button>
                <button onclick="showStoreState()">æŸ¥çœ‹çŠ¶æ€</button>
            </div>
            <div id="storeOutput" class="code-block" style="margin-top: 20px;">
                <code>ç‚¹å‡»æŒ‰é’®æŸ¥çœ‹çŠ¶æ€...</code>
            </div>
        </div>
        
        <!-- API æ¼”ç¤º -->
        <div class="demo-section">
            <h2>ğŸŒ API æœåŠ¡ (APIService)</h2>
            <div class="demo-controls">
                <button onclick="fetchGoldPrice()">è·å–é»„é‡‘ä»·æ ¼</button>
                <button onclick="fetchMarketData()">è·å–è‚¡ç¥¨æ•°æ®</button>
                <button onclick="checkHealth()">å¥åº·æ£€æŸ¥</button>
                <button onclick="clearCache()">æ¸…é™¤ç¼“å­˜</button>
            </div>
            <div id="apiOutput" class="code-block" style="margin-top: 20px;">
                <code>ç‚¹å‡»æŒ‰é’®è°ƒç”¨ API...</code>
            </div>
        </div>
    </div>

    <!-- å¼•å…¥æ¨¡å—åŒ–è„šæœ¬ -->
    <script src="../js/utils.js"></script>
    <script src="../js/store.js"></script>
    <script src="../js/services/api.js"></script>
    <script src="../js/components.js"></script>
    
    <script>
        // ä»·æ ¼å¡ç‰‡æ›´æ–°
        function updateCard1() {
            const card = document.querySelector('gp-price-card');
            const newPrice = 2600 + Math.random() * 100;
            const newChange = (Math.random() - 0.5) * 30;
            const newChangePercent = (newChange / newPrice) * 100;
            
            card.setAttribute('price', newPrice.toFixed(2));
            card.setAttribute('change', newChange.toFixed(2));
            card.setAttribute('change-percent', newChangePercent.toFixed(2));
        }
        
        function updateCard2() {
            const cards = document.querySelectorAll('gp-price-card');
            const card = cards[1];
            const newPrice = 19500 + Math.random() * 1000;
            const newChange = (Math.random() - 0.5) * 500;
            const newChangePercent = (newChange / newPrice) * 100;
            
            card.setAttribute('price', newPrice.toFixed(2));
            card.setAttribute('change', newChange.toFixed(2));
            card.setAttribute('change-percent', newChangePercent.toFixed(2));
        }
        
        // åŠ è½½çŠ¶æ€æ§åˆ¶
        function showLoading() {
            document.getElementById('demoLoading').show();
        }
        
        function hideLoading() {
            document.getElementById('demoLoading').hide();
        }
        
        // é”™è¯¯æç¤ºæ§åˆ¶
        function showError() {
            document.getElementById('demoError').show('ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè®¾ç½®åé‡è¯•');
        }
        
        function hideError() {
            document.getElementById('demoError').hide();
        }
        
        // å€’è®¡æ—¶æ§åˆ¶
        function startCountdown() {
            document.getElementById('demoCountdown').setAttribute('running', '');
        }
        
        function stopCountdown() {
            document.getElementById('demoCountdown').removeAttribute('running');
        }
        
        function resetCountdown() {
            document.getElementById('demoCountdown').reset(300);
        }
        
        // è¿·ä½ å›¾è¡¨æ›´æ–°
        function updateSparkline() {
            const sparkline = document.getElementById('demoSparkline');
            const data = [];
            let base = 2600;
            for (let i = 0; i < 20; i++) {
                base += (Math.random() - 0.5) * 50;
                data.push(base);
            }
            sparkline.setData(data);
        }
        
        // åˆå§‹åŒ–å›¾è¡¨
        setTimeout(updateSparkline, 100);
        
        // Store æ“ä½œ
        function addFavorite() {
            Store.addFavorite('XAU', 'é»„é‡‘');
            Store.addFavorite('HSI', 'æ’ç”ŸæŒ‡æ•°');
            showStoreState();
        }
        
        function removeFavorite() {
            Store.removeFavorite('XAU');
            showStoreState();
        }
        
        function toggleAutoRefresh() {
            const newState = Store.toggleAutoRefresh();
            console.log('Auto refresh:', newState);
        }
        
        function showStoreState() {
            const output = document.getElementById('storeOutput');
            const state = {
                favorites: Store.get('favorites'),
                autoRefresh: Store.get('autoRefresh'),
                currentMarket: Store.get('currentMarket'),
                alerts: Store.get('alerts')
            };
            output.innerHTML = '<code>' + JSON.stringify(state, null, 2) + '</code>';
        }
        
        // API æ“ä½œ
        async function fetchGoldPrice() {
            const output = document.getElementById('apiOutput');
            output.innerHTML = '<code>åŠ è½½ä¸­...</code>';
            try {
                const data = await APIService.getGoldPrice();
                output.innerHTML = '<code>' + JSON.stringify(data, null, 2).substring(0, 500) + '...</code>';
            } catch (e) {
                output.innerHTML = '<code style="color: #ff6666;">é”™è¯¯: ' + e.message + '</code>';
            }
        }
        
        async function fetchMarketData() {
            const output = document.getElementById('apiOutput');
            output.innerHTML = '<code>åŠ è½½ä¸­...</code>';
            try {
                const data = await APIService.getMarketData('hsi');
                output.innerHTML = '<code>' + JSON.stringify(data, null, 2) + '</code>';
            } catch (e) {
                output.innerHTML = '<code style="color: #ff6666;">é”™è¯¯: ' + e.message + '</code>';
            }
        }
        
        async function checkHealth() {
            const output = document.getElementById('apiOutput');
            output.innerHTML = '<code>æ£€æŸ¥ä¸­...</code>';
            try {
                const health = await APIService.healthCheck();
                output.innerHTML = '<code>' + JSON.stringify(health, null, 2) + '</code>';
            } catch (e) {
                output.innerHTML = '<code style="color: #ff6666;">é”™è¯¯: ' + e.message + '</code>';
            }
        }
        
        function clearCache() {
            APIService.clearCache();
            document.getElementById('apiOutput').innerHTML = '<code>ç¼“å­˜å·²æ¸…é™¤</code>';
        }
        
        // ç›‘å¬æ”¶è—å˜åŒ–
        Store.subscribe('favorites', (newVal) => {
            console.log('Favorites changed:', newVal);
        });
    </script>
</body>
</html>
